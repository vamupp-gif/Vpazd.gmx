<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_enemy3_idle</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// Mozgás és állapot
state = "idle";
hp = 2;
speed = 0;
wave_amplitude = 2;
wave_frequency = 0.1;
wave_offset = 0;

// Visszalökés
knockback_timer = 0;
knockback_speed = 2;

// Cél (pl. játékos)
target = obj_player;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// ====================================================================
//                         PLAYER1 + PLAYER2 KIVÁLASZTÁSA
// ====================================================================

var target = noone;
var nearest_player = noone;

// Ellenőrizzük az élő játékosokat
if (instance_exists(obj_player) &amp;&amp; !obj_player.is_dead) {
    nearest_player = obj_player;
}

if (instance_exists(obj_player2) &amp;&amp; !obj_player2.is_dead) {
    if (nearest_player == noone) {
        nearest_player = obj_player2;
    } else {
        // már van egy élő játékos -&gt; nézzük melyik a közelebbi
        var d1 = point_distance(x, y, nearest_player.x, nearest_player.y);
        var d2 = point_distance(x, y, obj_player2.x, obj_player2.y);
        if (d2 &lt; d1) nearest_player = obj_player2;
    }
}

target = nearest_player;

// Ha nincs élő target, idle állapot
if (target == noone) {
    state = "idle";
    sprite_index = spr_enemy3_idle;
    image_speed = 0.4;
    exit;
}

// ====================================================================
//                         TÁVOLSÁG A TARGETTŐL
// ====================================================================
var dx = target.x - x;
var dy = target.y - y;
var dist = point_distance(x, y, target.x, target.y);

// ====================================================================
//                          KNOCKBACK KEZELÉS
// ====================================================================
if (knockback_timer &gt; 0) {
    knockback_timer -= 1;

    x -= knockback_dx * knockback_speed;
    y -= knockback_dy * knockback_speed;

    exit;
}

// ====================================================================
//                           ÁLLAPOTVÁLTÁS
// ====================================================================
if (state == "idle" &amp;&amp; dist &lt; 200) {
    state = "chase";
    sprite_index = spr_enemy3_chase;
    image_speed = 0.4;
    speed = 1; 
}

// ====================================================================
//                                CHASE
// ====================================================================
if (state == "chase") {

    var angle = point_direction(x, y, target.x, target.y);

    // Mozgás irányvektor
    var vx = lengthdir_x(speed, angle);
    var vy = lengthdir_y(speed, angle);

    // Hullámzó mozgás
    wave_offset += wave_frequency;
    var wave = sin(wave_offset) * wave_amplitude;

    // Alap mozgás
    x += vx;
    y += vy + wave;

    // Kiegészítő gyors oldalirányú mozgás
    if (target.x &lt; x) {
        x -= speed * 2;
        image_xscale = -1;
    } else {
        x += speed;
        image_xscale = 1;
    }

    // Újabb hullám-eltolás
    wave_offset += wave_frequency;
    wave = sin(wave_offset) * wave_amplitude;
    y += wave;
}

// ====================================================================
//                                DEAD
// ====================================================================
if (state == "dead") {

    y += vspeed;
    vspeed += 1; // gravitáció

    if (y &gt; room_height + sprite_height) {
        instance_destroy();
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_bullet_machinegun">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>hp -= 1;
knockback_dx = sign(x - other.x);
knockback_dy = sign(y - other.y);
knockback_timer = 10;
sprite_index = spr_enemy3_hit;
image_speed = 0.4;

// Halál ellenőrzés
if (hp &lt;= 0) {
    state = "dead";
    sprite_index = spr_enemy3_dead;
    vspeed = -10;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_bullet_rocket">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>hp -= 4;
knockback_dx = sign(x - other.x);
knockback_dy = sign(y - other.y);
knockback_timer = 10;
sprite_index = spr_enemy3_hit;
image_speed = 0.4;

// Halál ellenőrzés
if (hp &lt;= 0) {
    state = "dead";
    sprite_index = spr_enemy3_dead;
    vspeed = -10;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_bullet_shotgun">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>hp -= 2;
knockback_dx = sign(x - other.x);
knockback_dy = sign(y - other.y);
knockback_timer = 10;
sprite_index = spr_enemy3_hit;
image_speed = 0.4;

// Halál ellenőrzés
if (hp &lt;= 0) {
    state = "dead";
    sprite_index = spr_enemy3_dead;
    vspeed = -10;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_bullet_pistol">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>hp -= 1;
knockback_dx = sign(x - other.x);
knockback_dy = sign(y - other.y);
knockback_timer = 10;
sprite_index = spr_enemy3_hit;
image_speed = 0.4;

// Halál ellenőrzés
if (hp &lt;= 0) {
    state = "dead";
    sprite_index = spr_enemy3_dead;
    vspeed = -10;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_bullet">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>hp -= 1;
knockback_dx = sign(x - other.x);
knockback_dy = sign(y - other.y);
knockback_timer = 10;
sprite_index = spr_enemy3_hit;
image_speed = 0.4;

// Halál ellenőrzés
if (hp &lt;= 0) {
    state = "dead";
    sprite_index = spr_enemy3_dead;
    vspeed = -10;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
